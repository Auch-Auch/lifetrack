# Response templates for bot intents
# Jinja2 syntax with custom filters

query_schedule: |
  üìÖ **Your Schedule:**
  {% if data.events is defined and data.events|length > 0 %}
  {% for event in data.events %}
  ‚Ä¢ **{{ event.startTime|format_time }}** - {{ event.title }} {{ event.type|event_icon }}
  {% if event.description %}  _{{ event.description|truncate(50) }}_{% endif %}
  {% endfor %}
  {% else %}
  No events scheduled for {{ params.date|default('today') }}.
  {% endif %}

start_session: |
  ‚è±Ô∏è **Session Started!**
  
  Activity: {{ data.name|default('Session') }}
  Skill: {{ data.skill_name|default(data.skill.name if data.skill else 'Unknown') }}
  {% if data.skill_was_created %}
  üìö Created new skill: {{ data.skill_name }}
  {% endif %}
  
  Good luck! Message me when you're done.

stop_session: |
  ‚úÖ **Session Completed!**
  
  Activity: {{ data.name|default('Session') }}
  Duration: {{ data.duration|format_duration }}
  {% if data.notes %}
  Notes: {{ data.notes }}
  {% endif %}
  
  Great work! Keep it up! üí™

end_session: |
  ‚úÖ **Session Ended!**
  
  Total time: {{ data.duration|format_duration }}
  
  Well done!

get_stats: |
  üìä **Your Activity Statistics**
  {% set stats = data.activityStats if data.activityStats is defined else data %}
  
  üéØ Total: {{ stats.totalActivities }} {{ stats.totalActivities|pluralize('activity', 'activities') }}
  ‚è±Ô∏è Time: {{ stats.totalHours }}h ({{ stats.totalMinutes }}m)
  {% if stats.skillBreakdown and stats.skillBreakdown|length > 0 %}
  
  üìö **By Skill:**
  {% for breakdown in stats.skillBreakdown[:5] %}
  ‚Ä¢ {{ breakdown.skillName }}: {{ breakdown.activityCount }} {{ breakdown.activityCount|pluralize('activity', 'activities') }}, {{ breakdown.totalHours|round(1) }}h
  {% endfor %}
  {% if stats.skillBreakdown|length > 5 %}
  _...and {{ stats.skillBreakdown|length - 5 }} more skills_
  {% endif %}
  {% endif %}
  
  {% if stats.totalActivities > 0 %}üí™ Keep up the great work!{% else %}üí° No activities yet. Start tracking!{% endif %}

calculate_stats: |
  üìä **Statistics** 
  
  Activities: {{ data.totalActivities|default(0) }}
  Time: {{ data.totalHours|default(0)|round(1) }}h

create_event: |
  ‚úÖ **Event Scheduled!**
  
  üìÖ {{ data.title }}
  üïê {{ data.startTime|format_datetime }}
  ‚è±Ô∏è Duration: {{ ((data.endTime|string|length > 0 and data.startTime|string|length > 0)|ternary('varies', params.duration|default(60)|format_duration)) }}
  {% if data.type %}
  Type: {{ data.type|capitalize }}
  {% endif %}
  
  You'll be reminded before it starts!

schedule_event: |
  ‚úÖ **Event Created!**
  
  üìÖ "{{ data.title }}"
  üïê {{ data.date|format_date }} at {{ data.time }}
  ‚è±Ô∏è {{ data.duration|default(60) }} minutes
  
  I'll remind you!

list_skills: |
  {% if data.skills is defined %}{% set skills_list = data.skills %}{% else %}{% set skills_list = data %}{% endif %}
  {% if skills_list|length > 0 %}
  üéØ **Your Skills** ({{ skills_list|length }} total):
  
  {% for skill in skills_list %}
  ‚Ä¢ **{{ skill.name }}**{% if skill.level %} {{ skill.level|skill_level_emoji }} ({{ skill.level }}){% endif %}
  {% if skill.notes %}  _{{ skill.notes|truncate(60) }}_{% endif %}
  {% endfor %}
  {% else %}
  üéØ You don't have any skills tracked yet.
  
  Start a learning session to create your first skill!
  {% endif %}

list_notes: |
  {% if data.notes is defined %}{% set notes_list = data.notes.nodes if data.notes.nodes is defined else data.notes %}{% elif data.searchNotes is defined %}{% set notes_list = data.searchNotes %}{% else %}{% set notes_list = data %}{% endif %}
  {% if notes_list|length > 0 %}
  üìù **Your Notes** ({{ notes_list|length }} {{ notes_list|length|pluralize('note') }}):
  
  {% set visible_notes, remaining = summarize_list(notes_list, 10) %}
  {% for note in visible_notes %}
  ‚Ä¢ **{{ note.title }}**{% if note.tags and note.tags|length > 0 %} #{{ note.tags|join(' #') }}{% endif %}
  {% if note.content %}  _{{ note.content|truncate(60) }}_{% endif %}
  {% endfor %}
  {% if remaining > 0 %}
  
  _...and {{ remaining }} more. Use the web app to see all._
  {% endif %}
  {% else %}
  üìù You don't have any notes yet.
  
  Try: "Create a note about..."
  {% endif %}

create_note: |
  ‚úÖ **Note Created!**
  
  üìù {{ data.title }}
  {% if data.tags and data.tags|length > 0 %}
  Tags: #{{ data.tags|join(' #') }}
  {% endif %}
  
  Successfully saved your note.

get_active_session: |
  {% if data.activeSession %}
  ‚è±Ô∏è **Active Session:**
  
  Activity: {{ data.activeSession.name }}
  Started: {{ data.activeSession.startedAt|format_datetime }}
  Status: {{ data.activeSession.status|capitalize }}
  {% else %}
  No active session running.
  
  Start one with: "Start learning session for [skill]"
  {% endif %}

list_activities: |
  {% if data.activities is defined and data.activities.nodes is defined %}
  {% set activity_list = data.activities.nodes %}
  {% set total = data.activities.totalCount %}
  {% else %}
  {% set activity_list = data if data is iterable and data is not string else [] %}
  {% set total = activity_list|length %}
  {% endif %}
  
  {% if activity_list|length > 0 %}
  ‚ö° **Your Activities** ({{ total }} total):
  
  {% for activity in activity_list %}
  ‚Ä¢ **{{ activity.name }}** - {{ activity.duration|format_duration }}
    {{ activity.date|format_date }}{% if activity.skill %} ({{ activity.skill.name }}){% endif %}
  {% endfor %}
  {% if data.activities is defined and data.activities.hasMore %}
  
  _Use the web app to see more activities._
  {% endif %}
  {% else %}
  ‚ö° No activities found.
  
  Start tracking with: "Start learning session"
  {% endif %}

# Generic responses
default: |
  ‚úÖ Done!

success: |
  ‚úÖ Success!

error: |
  ‚ùå Something went wrong. Please try again.

clarify: |
  ü§î {{ data.question|default("Could you please clarify?") }}

no_results: |
  No results found.
